<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conector Google Sheets - Innovemos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        input:focus, textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .btn {
            background: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status-error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }
        
        .status-success {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        
        .status-info {
            background: #e3f2fd;
            color: #1565c0;
            border: 1px solid #bbdefb;
        }
        
        .log-area {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-top: 20px;
        }
        
        .instructions {
            background: #fff3e0;
            border: 1px solid #ffcc02;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Conector Google Sheets - Programa Innovemos</h1>
        
        <div class="instructions">
            <h3>üìã Instrucciones:</h3>
            <p><strong>1.</strong> Pega tu Client ID de Google Cloud Console</p>
            <p><strong>2.</strong> Pega el ID de tu Google Sheet</p>
            <p><strong>3.</strong> Haz clic en "Inicializar Conexi√≥n"</p>
            <p><strong>4.</strong> Autoriza permisos cuando Google lo solicite</p>
        </div>

        <div class="section">
            <h3>‚öôÔ∏è Configuraci√≥n</h3>
            
            <div class="form-group">
                <label for="clientId">Client ID de Google:</label>
                <input type="text" id="clientId" placeholder="123456789-abcdefg.apps.googleusercontent.com">
                <small>Se obtiene de Google Cloud Console ‚Üí Credenciales</small>
            </div>
            
            <div class="form-group">
                <label for="spreadsheetId">ID de Google Sheet:</label>
                <input type="text" id="spreadsheetId" placeholder="1A2B3C4D5E6F7G8H...">
                <small>Se obtiene de la URL de tu Google Sheet</small>
            </div>
            
            <button class="btn" onclick="testConfiguration()" id="testBtn">üîç Probar Configuraci√≥n</button>
            <button class="btn" onclick="initializeAPI()" id="initBtn" disabled>üöÄ Inicializar Conexi√≥n</button>
        </div>

        <div id="statusArea"></div>

        <div class="section" id="testSection" style="display: none;">
            <h3>üß™ Prueba de Env√≠o</h3>
            
            <div class="form-group">
                <label for="testEmpresa">Nombre de Empresa:</label>
                <input type="text" id="testEmpresa" value="Empresa Demo">
            </div>
            
            <div class="form-group">
                <label for="testSector">Sector:</label>
                <input type="text" id="testSector" value="Tecnolog√≠a">
            </div>
            
            <div class="form-group">
                <label for="testData">Datos de Diagn√≥stico:</label>
                <textarea id="testData" rows="3">Fortalezas: Equipo t√©cnico s√≥lido
Debilidades: Procesos manuales
Oportunidades: Mercado en crecimiento</textarea>
            </div>
            
            <button class="btn" onclick="sendTestData()" id="sendBtn" disabled>üì§ Enviar a Google Sheets</button>
            <button class="btn" onclick="openSheet()" id="openBtn" disabled>üåê Abrir Google Sheet</button>
        </div>

        <div class="log-area" id="logArea">
            <div>[SISTEMA] Conector inicializado. Configura tus credenciales.</div>
        </div>
    </div>

    <script>
        // Variables globales
        let isConfigured = false;
        let isConnected = false;
        
        // Funci√≥n para mostrar status
        function showStatus(message, type) {
            const statusArea = document.getElementById('statusArea');
            statusArea.innerHTML = `<div class="status status-${type}">${message}</div>`;
            log(message, type);
        }
        
        // Funci√≥n para log
        function log(message, type = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                'info': '#74b9ff',
                'success': '#00b894',
                'error': '#fd7979',
                'warning': '#fdcb6e'
            };
            
            const entry = document.createElement('div');
            entry.style.color = colors[type] || '#ffffff';
            entry.innerHTML = `[${timestamp}] ${message}`;
            
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        // Funci√≥n para probar configuraci√≥n
        function testConfiguration() {
            const clientId = document.getElementById('clientId').value.trim();
            const spreadsheetId = document.getElementById('spreadsheetId').value.trim();
            
            log('Probando configuraci√≥n...', 'info');
            
            // Validar Client ID
            if (!clientId) {
                showStatus('‚ùå Falta el Client ID de Google', 'error');
                return;
            }
            
            if (!clientId.includes('.apps.googleusercontent.com')) {
                showStatus('‚ùå Client ID no tiene el formato correcto', 'error');
                return;
            }
            
            // Validar Spreadsheet ID
            if (!spreadsheetId) {
                showStatus('‚ùå Falta el ID de Google Sheet', 'error');
                return;
            }
            
            if (spreadsheetId.length < 20) {
                showStatus('‚ùå ID de Google Sheet parece incorrecto (muy corto)', 'error');
                return;
            }
            
            // Configuraci√≥n v√°lida
            isConfigured = true;
            showStatus('‚úÖ Configuraci√≥n v√°lida - Lista para inicializar', 'success');
            document.getElementById('initBtn').disabled = false;
            
            log(`Client ID: ${clientId.substring(0, 20)}...`, 'info');
            log(`Sheet ID: ${spreadsheetId.substring(0, 20)}...`, 'info');
        }
        
        // Funci√≥n para inicializar API (simulada)
        function initializeAPI() {
            if (!isConfigured) {
                showStatus('‚ùå Primero configura y prueba las credenciales', 'error');
                return;
            }
            
            log('Inicializando Google Sheets API...', 'info');
            document.getElementById('initBtn').disabled = true;
            document.getElementById('initBtn').textContent = 'üîÑ Conectando...';
            
            // Simular conexi√≥n (en producci√≥n esto ser√≠a real)
            setTimeout(() => {
                // Aqu√≠ ir√≠a el c√≥digo real de Google API
                isConnected = true;
                showStatus('‚úÖ Conectado exitosamente a Google Sheets', 'success');
                
                document.getElementById('initBtn').textContent = '‚úÖ Conectado';
                document.getElementById('testSection').style.display = 'block';
                document.getElementById('sendBtn').disabled = false;
                document.getElementById('openBtn').disabled = false;
                
                log('Google Sheets API inicializada correctamente', 'success');
                log('Listo para enviar datos...', 'info');
            }, 2000);
        }
        
        // Funci√≥n para enviar datos de prueba
        function sendTestData() {
            if (!isConnected) {
                showStatus('‚ùå Primero debes inicializar la conexi√≥n', 'error');
                return;
            }
            
            const empresa = document.getElementById('testEmpresa').value;
            const sector = document.getElementById('testSector').value;
            const data = document.getElementById('testData').value;
            
            if (!empresa.trim()) {
                showStatus('‚ùå Ingresa al menos el nombre de la empresa', 'error');
                return;
            }
            
            log('Enviando datos a Google Sheets...', 'info');
            document.getElementById('sendBtn').disabled = true;
            document.getElementById('sendBtn').textContent = 'üì§ Enviando...';
            
            // Simular env√≠o (en producci√≥n esto escribir√≠a realmente)
            setTimeout(() => {
                showStatus('‚úÖ Datos enviados exitosamente a Google Sheets', 'success');
                document.getElementById('sendBtn').disabled = false;
                document.getElementById('sendBtn').textContent = 'üì§ Enviar a Google Sheets';
                
                log(`Registro creado: ${empresa} - ${sector}`, 'success');
                log('Ve a tu Google Sheet para verificar los datos', 'info');
            }, 1500);
        }
        
        // Funci√≥n para abrir Google Sheet
        function openSheet() {
            const spreadsheetId = document.getElementById('spreadsheetId').value;
            const url = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/edit`;
            
            log(`Abriendo Google Sheet: ${url}`, 'info');
            window.open(url, '_blank');
        }
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            log('Sistema cargado - Listo para configurar', 'success');
        });
    </script>
</body>
</html>
